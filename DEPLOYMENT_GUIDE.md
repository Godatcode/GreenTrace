# 🚀 GreenTrace - Complete Deployment Guide

## 📋 Overview

GreenTrace is a comprehensive Carbon Credit & Supply Chain Transparency Platform with advanced privacy controls and role-based access management. This guide covers the complete deployment of all components.

## 🏗️ Architecture

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Frontend      │    │   Backend       │    │   Smart         │
│   (Vercel)      │◄──►│   (Render)      │◄──►│   Contracts     │
│   React/TS      │    │   Django        │    │   (Avalanche)   │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 🌐 Live URLs

- **Frontend**: [Your Vercel URL]
- **Backend**: https://greentrace-backend-eh4d.onrender.com/
- **Smart Contracts**: Avalanche Fuji Testnet

## 📦 Components

### 1. Frontend (React + TypeScript)
- **Platform**: Vercel
- **Framework**: React 18 with TypeScript
- **Features**: 
  - Product management
  - Carbon credit trading
  - Role-based access control
  - Blockchain integration

### 2. Backend (Django REST API)
- **Platform**: Render
- **Framework**: Django 5.0.1
- **Database**: SQLite (production ready for PostgreSQL)
- **Features**:
  - REST API endpoints
  - User authentication
  - Data privacy controls
  - CORS enabled

### 3. Smart Contracts (Solidity)
- **Network**: Avalanche Fuji Testnet
- **Language**: Solidity 0.8.28
- **Contracts**:
  - ProductRegistry: `0x78D866f9704FF874A3484C79aC9405947648588c`
  - CarbonCredit: `0x3b7Cbb8C26d2101dBC3808Cc597BCA879001160d`

## 🔧 Local Development Setup

### Prerequisites
- Node.js 18+
- Python 3.13+
- Git

### 1. Clone Repository
```bash
git clone https://github.com/Godatcode/GreenTrace.git
cd GreenTrace
```

### 2. Frontend Setup
```bash
cd frontend
npm install
npm start
```

### 3. Backend Setup
```bash
cd backend
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt
python manage.py migrate
python manage.py runserver
```

### 4. Smart Contracts Setup
```bash
# Install dependencies
npm install

# Create .env file
echo "AVALANCHE_FUJI_URL=https://api.avax-test.network/ext/bc/C/rpc" > .env
echo "PRIVATE_KEY=your_private_key_here" >> .env

# Compile contracts
npx hardhat compile

# Deploy to testnet
npx hardhat run scripts/deploy.ts --network fuji
```

## 🚀 Production Deployment

### Frontend Deployment (Vercel)

1. **Connect Repository**
   - Go to [vercel.com](https://vercel.com)
   - Import your GitHub repository
   - Set root directory to `frontend`

2. **Environment Variables**
   ```
   REACT_APP_API_URL=https://greentrace-backend-eh4d.onrender.com
   ```

3. **Deploy**
   - Vercel automatically deploys on git push
   - Custom domain can be configured

### Backend Deployment (Render)

1. **Create Web Service**
   - Go to [render.com](https://render.com)
   - Connect GitHub repository
   - Set root directory to `backend`

2. **Configuration**
   ```
   Build Command: pip install -r requirements.txt && python manage.py collectstatic --noinput
   Start Command: python manage.py migrate && python manage.py runserver 0.0.0.0:$PORT
   ```

3. **Environment Variables**
   ```
   SECRET_KEY: [Auto-generated by Render]
   DEBUG: False
   ALLOWED_HOSTS: *.onrender.com,localhost,127.0.0.1
   CORS_ALLOWED_ORIGINS: https://your-frontend.vercel.app
   ```

### Smart Contracts Deployment

1. **Setup MetaMask**
   - Add Avalanche Fuji network
   - Get testnet AVAX from faucet

2. **Deploy Contracts**
   ```bash
   npx hardhat run scripts/deploy.ts --network fuji
   ```

3. **Update Frontend**
   - Update contract addresses in `frontend/src/App.tsx`
   - Redeploy frontend

## 🔗 API Endpoints

### Authentication
- `GET /api/auth/check/` - Check authentication status
- `POST /api/auth/login/` - User login
- `POST /api/auth/logout/` - User logout
- `POST /api/auth/register/` - User registration

### Products
- `GET /api/products/` - List products
- `POST /api/products/create/` - Create product
- `GET /api/products/{id}/` - Get product details
- `PUT /api/products/{id}/` - Update product

### Carbon Credits
- `GET /api/credits/` - List carbon credits
- `POST /api/credits/create/` - Issue credit
- `PUT /api/credits/{id}/transfer/` - Transfer credit
- `PUT /api/credits/{id}/retire/` - Retire credit

## 🔐 User Roles

### 🌐 Public User
- View public product data only
- No sensitive information access

### 🔒 Private User
- View public + private data
- Producer details, descriptions
- Basic carbon activity info

### 🏢 Enterprise User
- View public + private + enterprise data
- IoT sensor data, detailed carbon info
- Business partner access

### 🔑 Admin/Regulator
- View ALL data for compliance
- Full system access

## 🛠️ Troubleshooting

### Backend Issues
```bash
# Check if backend is running
curl https://greentrace-backend-eh4d.onrender.com/

# Check local backend
curl http://localhost:8000/
```

### Frontend Issues
- Check browser console for errors
- Verify API endpoints are accessible
- Check CORS configuration

### Smart Contract Issues
```bash
# Check wallet balance
npx hardhat run scripts/check-balance.ts --network fuji

# Verify contract deployment
npx hardhat run scripts/deploy.ts --network fuji
```

## 📊 Monitoring

### Backend Health
- **Health Check**: `GET /`
- **Test Endpoint**: `GET /test/`
- **Admin Panel**: `GET /admin/`

### Smart Contracts
- **Block Explorer**: [Snowtrace Testnet](https://testnet.snowtrace.io/)
- **ProductRegistry**: [View Contract](https://testnet.snowtrace.io/address/0x78D866f9704FF874A3484C79aC9405947648588c)
- **CarbonCredit**: [View Contract](https://testnet.snowtrace.io/address/0x3b7Cbb8C26d2101dBC3808Cc597BCA879001160d)

## 🔄 Updates & Maintenance

### Frontend Updates
1. Make changes in `frontend/src/`
2. Commit and push to GitHub
3. Vercel automatically redeploys

### Backend Updates
1. Make changes in `backend/`
2. Commit and push to GitHub
3. Render automatically redeploys

### Smart Contract Updates
1. Update contracts in `contracts/`
2. Deploy new contracts
3. Update frontend with new addresses
4. Redeploy frontend

## 📝 Environment Variables

### Frontend (.env)
```
REACT_APP_API_URL=https://greentrace-backend-eh4d.onrender.com
```

### Backend (.env)
```
SECRET_KEY=your-secret-key
DEBUG=False
ALLOWED_HOSTS=*.onrender.com,localhost,127.0.0.1
CORS_ALLOWED_ORIGINS=https://your-frontend.vercel.app
```

### Smart Contracts (.env)
```
AVALANCHE_FUJI_URL=https://api.avax-test.network/ext/bc/C/rpc
PRIVATE_KEY=your-private-key
```

## 🎯 Next Steps

1. **Production Database**: Migrate to PostgreSQL
2. **Custom Domain**: Configure custom domains
3. **SSL Certificates**: Ensure HTTPS everywhere
4. **Monitoring**: Add application monitoring
5. **Backup**: Implement data backup strategy

## 📞 Support

For issues or questions:
- Check the troubleshooting section
- Review logs in deployment platforms
- Check GitHub issues

---

**Last Updated**: September 13, 2025
**Version**: 1.0.0
**Status**: ✅ Fully Deployed and Operational
